generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:password@localhost:5432/gbdb?schema=public"
}

model TwitchAuthToken {
  type            String @unique
  twitchAuthToken String
}

model User {
  id         String    @id @unique
  userName   String?
  games      Game[]
  followedBy Follows[] @relation("followedBy")
  following  Follows[] @relation("following")
}

model Follows {
  followedBy      User   @relation("followedBy", fields: [followedById], references: [id], onDelete: Cascade)
  followedById    String
  followedByUName String
  following       User   @relation("following", fields: [followingId], references: [id], onDelete: Cascade)
  followingId     String
  followingUName  String
  game            Game   @relation(fields: [gameId], references: [id], onDelete: Cascade)
  gameId          Int
  gameName        String

  @@id([followingId, followedById])
}

model Game {
  id               Int        @id @unique
  name             String
  summary          String?
  url              String?
  platformIds      Int[]
  modeIds          Int[]
  genreIds         Int[]
  platforms        Platform[]
  modes            Mode[]
  genres           Genre[]
  users            User[]
  firstReleaseDate Int?
  totalRating      Float?
  Follows          Follows[]
}

model Platform {
  id    Int    @id @unique
  name  String
  games Game[]
}

model Mode {
  id    Int    @id @unique
  name  String
  games Game[]
}

model Genre {
  id    Int    @id @unique
  name  String
  games Game[]
}
